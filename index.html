<!DOCTYPE html>
<html lang="ja">
<head>
  <meta name="description" content="英語単語しりとりゲーム。30秒以内にいくつ単語を答えられるか競う無料ブラウザゲーム。語彙力アップにおすすめ。">
  <meta name="keywords" content="英単語, しりとり, 英語ゲーム, 英語学習, vocabulary game">
  <meta name="robots" content="index, follow">

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <!-- OGP -->
  <meta property="og:title" content="英単語しりとりゲーム">
  <meta property="og:description" content="英単語しりとりで語彙力アップ！30秒以内にいくつ答えられるか！？ブラウザで遊べる英語学習ゲーム。">
  <meta property="og:image" content="https://english-words-shiritori.netlify.app/ogp.png" />
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://english-words-shiritori.netlify.app/">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="英単語しりとりゲーム" />
  <meta name="twitter:description" content="英語の語彙力を遊びながら強化できる英単語しりとりゲーム。" />
  <meta name="twitter:image" content="https://english-words-shiritori.netlify.app/ogp.png" />

  <title>英単語しりとり | 英語力を鍛えるWebゲーム</title>

  <style>
  :root {
    --bg: #f7f9fc;
    --text-main: #1a1a1a;
    --text-sub: #666;
    --white: #fff;
    --accent: #4f46e5;
    --radius: 16px;
    --shadow: 0 8px 20px rgba(0, 0, 0, 0.06);
  }

  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background: var(--bg);
    margin: 0;
    padding: 20px;
    display: flex;
    justify-content: center;
  }

  .container {
    background: var(--white);
    padding: 28px;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    width: 360px;
    box-sizing: border-box;
  }

  h1 {
    font-size: 1.4rem;
    margin-top: 0;
    margin-bottom: 16px;
    text-align: center;
    font-weight: 600;
  }

  p {
    margin: 6px 0;
    font-size: 14px;
    color: var(--text-main);
  }

  .label {
    font-weight: bold;
  }

  /* ---- Buttons ---- */
  #startBtn, #okBtn {
    width: 100%;
    padding: 10px;
    font-size: 16px;
    border: none;
    border-radius: 999px;
    cursor: pointer;
    color: #fff;
    margin-top: 10px;
    transition: transform 0.1s ease-out, background 0.2s ease;
  }

  #startBtn {
    background: var(--accent);
    font-weight: 600;
  }

  #startBtn:hover {
    background: #4338ca;
    transform: translateY(-2px);
  }

  #okBtn {
    background: var(--accent);
    font-weight: 600;
  }

  #okBtn:hover {
    background: #4338ca;
    transform: translateY(-2px);
  }

  #okBtn:disabled {
    background: #999;
    cursor: not-allowed;
  }

  /* ---- Input ---- */
  #inputWord {
    width: 100%;
    padding: 10px;
    font-size: 16px;
    box-sizing: border-box;
    margin-top: 8px;
    border-radius: 8px;
    border: 1px solid #ccc;
  }

  /* ---- status ---- */
  .status-row {
    display: flex;
    justify-content: space-between;
    margin-top: 14px;
    font-size: 14px;
    color: var(--text-sub);
  }

  #message {
    margin-top: 12px;
    min-height: 18px;
    font-size: 14px;
    color: #d32f2f;
  }

  .hint {
    margin-top: 6px;
    font-size: 12px;
    color: var(--text-sub);
  }

  /* ---- back to home ---- */
  .back-home {
    margin-top: 26px;
    text-align: center;
  }
  .back-home a {
    display: inline-block;
    padding: 10px 18px;
    background: var(--accent);
    color: #fff;
    border-radius: 999px;
    text-decoration: none;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s ease, transform 0.1s ease-out;
  }
  .back-home a:hover {
    background: #4338ca;
    transform: translateY(-2px);
  }
  </style>
</head>

<body>
  <div class="container">
    <h1>英単語しりとり</h1>

    <button id="startBtn">スタート</button>

    <p><span class="label">前の単語：</span><span id="prevWord">apple</span></p>
    <p><span class="label">最後の文字：</span><span id="lastChar">e</span></p>

    <input id="inputWord" placeholder="英単語を入力（例：elephant）" autocomplete="off" disabled />
    <button id="okBtn" disabled>辞書読み込み中...</button>

    <div class="status-row">
      <p>スコア：<span id="score">0</span></p>
      <p>残り：<span id="time">30</span> 秒</p>
    </div>

    <p id="message"></p>

    <button id="restartBtn" style="display:none; margin-top:12px; width:100%; padding:10px;
  border:none; border-radius:6px; background:#4f46e5; color:white; font-size:16px; cursor:pointer;">
  もう一度挑戦する
    </button>


    <p class="hint">※ 小文字推奨・1行1単語で入力してください</p>

    <div class="back-home">
      <a href="https://english-learning-games.netlify.app/">← ホームへ戻る</a>
    </div>
  </div>

  <!-- script はそのまま -->
  <script>
// =========================
//  辞書読み込み
// =========================
let DICTIONARY = new Set();
let dictLoaded = false;

async function loadDictionary() {
  try {
    const res = await fetch("dictionary.txt"); // 同じフォルダの辞書ファイル
    if (!res.ok) {
      throw new Error("HTTP error " + res.status);
    }

    const text = await res.text();
    const lines = text.split(/\r?\n/);

    lines.forEach((line) => {
      const w = line.trim().toLowerCase();
      if (w) DICTIONARY.add(w);
    });

    dictLoaded = true;
    okBtn.disabled = false;
    okBtn.textContent = "OK";
    showMessage(`辞書読み込み完了（${DICTIONARY.size}語）`, false);
  } catch (e) {
    console.error(e);
    showMessage("辞書の読み込みに失敗しました。", true);
    okBtn.disabled = true;
    okBtn.textContent = "エラー";
  }
}

// =========================
//  しりとりゲーム本体
// =========================
let prevWord = "apple";       // 最初の単語
let usedWords = ["apple"];    // 使用済み単語
let score = 0;
let timeLeft = 30;
let gameOver = false;

const prevWordEl = document.getElementById("prevWord");
const lastCharEl = document.getElementById("lastChar");
const inputEl = document.getElementById("inputWord");
const scoreEl = document.getElementById("score");
const timeEl = document.getElementById("time");
const okBtn = document.getElementById("okBtn");
const messageEl = document.getElementById("message");
const restartBtn = document.getElementById("restartBtn");

// 最初の最後の文字
lastCharEl.textContent = prevWord.slice(-1);

// 前後の半角・全角スペースを削る
function trimSpaces(str) {
  return str.replace(/^[\s\u3000]+|[\s\u3000]+$/g, "");
}

// メッセージ表示
function showMessage(msg, isError = true) {
  messageEl.style.color = isError ? "#d32f2f" : "#1976d2";
  messageEl.textContent = msg;
}

// 単語の判定＆更新
function submitWord() {
  if (gameOver || timeLeft <= 0) return;

  if (!dictLoaded) {
    showMessage("辞書読み込み中です。少し待ってね。");
    return;
  }

  let word = inputEl.value.toLowerCase();
  word = trimSpaces(word);
  inputEl.value = "";

  if (!word) {
    showMessage("単語を入力してね。");
    return;
  }

  // 英字のみ
  if (!/^[a-z]+$/.test(word)) {
    showMessage("英字のみで入力してください。（a〜z）");
    return;
  }

  // 辞書チェック
  if (!DICTIONARY.has(word)) {
    showMessage("辞書に登録されていない単語です。", true);
    return;
  }

  const lastChar = prevWord.slice(-1);

  // 先頭文字チェック
  if (word[0] !== lastChar) {
    showMessage(`しりとりのルール違反！「${lastChar}」から始めてね。`);
    return;
  }

  // 再利用
  if (usedWords.includes(word)) {
    showMessage("その単語はすでに使っています。");
    return;
  }

  // OK
  prevWord = word;
  usedWords.push(word);
  score++;

  prevWordEl.textContent = word;
  lastCharEl.textContent = word.slice(-1);
  scoreEl.textContent = score;
  showMessage("OK！次の単語へ！", false);

  inputEl.focus();
}

// タイマー
let timerId = null;

// スタートボタン
const startBtn = document.getElementById("startBtn");

function startGame() {
  if (timerId !== null) return;

  inputEl.disabled = false;
  okBtn.disabled = false;
  inputEl.focus();

  startBtn.style.display = "none";

  // タイマー開始
  timerId = setInterval(() => {
    if (timeLeft > 0) {
      timeLeft--;
      timeEl.textContent = timeLeft;

      if (timeLeft === 0) {
        gameOver = true;
        okBtn.disabled = true;
        inputEl.disabled = true;
        showMessage(`時間切れ！最終スコア：${score}`, true);
        clearInterval(timerId);

        restartBtn.style.display = "block"; 
      }
    }
  }, 1000);
}

startBtn.addEventListener("click", startGame);
okBtn.addEventListener("click", submitWord);

inputEl.addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    submitWord();
  }
});

window.addEventListener("load", () => {
  loadDictionary();
});

function restartGame() {
  // 初期化
  prevWord = "apple";
  usedWords = ["apple"];
  score = 0;
  timeLeft = 30;
  gameOver = false;

  prevWordEl.textContent = prevWord;
  lastCharEl.textContent = "e";
  scoreEl.textContent = "0";
  timeEl.textContent = "30";

  inputEl.value = "";
  inputEl.disabled = false;
  okBtn.disabled = !dictLoaded;
  messageEl.textContent = "";

  // ボタン非表示
  restartBtn.style.display = "none";

  // タイマー再開
  timerId = null;
  startGame();
}
restartBtn.addEventListener("click", restartGame);

  </script>
</body>
</html>
